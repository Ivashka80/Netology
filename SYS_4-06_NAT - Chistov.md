# Домашнее задание к занятию "Сеть и сетевые протоколы: NAT"
<details> 
Эти задания обязательные к выполнению. Пожалуйста, присылайте на проверку все задачи сразу. Любые вопросы по решению задач задавайте в чате учебной группы.

---
### Цели задания
1. Научиться правильно настраивать трансляцию ip-адресов на сетевых интерфейсах.
2. Обеспечить доступность внутреннего сервера через трансляцию ip-адресов.
3. Создавать списки доступа для NAT-трансляций.

Данная практика закрепляет знания о работе технологии NAT. Эти навыки пригодятся для понимания принципов построения сети и создания связности сетевых устройств и сервисов между собой.

### Чек-лист готовности к домашнему заданию
- Прочитайте статью ["Как пользоваться программой Cisco Packet Tracer"](https://pc.ru/articles/osnovy-raboty-s-cisco-packet-tracer).
- Установите программу Cisco Packet Tracer на своем компьютере.
- Выполните домашние задание ["4.5. Сеть и сетевые протоколы: Firewall"](https://github.com/netology-code/snet-homeworks/blob/snet-18/4-09.md).

### Инструкция по выполнению: 
- Выполните два задания.
- Сделайте скриншоты из Cisco Packet Tracer по итогам выполнения каждого задания.
- Отправьте на проверку в личном кабинете Нетологии два .pkt файла. Файлы прикрепите в раздел "решение" в практическом задании.
- В комментариях к решению в личном кабинете Нетологии напишите пояснения к полученным результатам. 
---

## Задание 1. Создание внешней сети и настройка NAT

*ВАЖНО. Задание является сквозным и составлено на основе практической задачи из домашней работы “Firewall”.* 

### Описание задания
Перед вами стоит задача сделать “внешнюю сеть” интернет-провайдера и создать для сетевых устройств доступность “внешнего мира”

В вашем распоряжении есть две сети:

*188.144.1.0/30 - интернет провайдер выделил данную сеть для подключения мини-офиса*

*188.144.0.0/30 - интернет провайдер выделил данную сеть для подключения  главного офиса* 

Необходимо подключить каждую из частей офиса подключить к интернет-провайдеру

### Требование к результату
- Вы должны отправить файл .pkt с выполненным заданием. 
- К выполненной задаче добавьте скриншоты с доступностью “внешней сети” и ответы на вопросы.

### Процесс выполнения
1. Запустите программу Cisco Packet Tracer
2. В программе Cisco Packet Tracer загрузите предыдущую практическую работу.
3. Текущее физическое соединение между двумя маршрутизаторами необходимо разорвать.
4. Добавьте еще один маршрутизатор интернет-провайдера и соединить его с двумя другими.
5. Между всеми маршрутизаторами необходимо создать сетевую связность.
6. На каждом маршрутизаторе главного и мини-офиса настройте внутренние и внешние интерфейсы (inside, outside)
7. На каждом маршрутизаторе создайте списки доступа сетей, которые будут транслироваться во “внешнюю сеть”
8. На каждом маршрутизаторе создайте NAT-трансляцию с помощью вышеуказанного access-листа.
9. Проверьте доступность с любого конечного устройства доступность роутера интернет-провайдера, командой ping.
10. Во время проверки командой ping посмотрите на каждом роутере списки трансляции адресов. Сделайте скриншот.
11. Ответ внесите в комментарии к решению задания в личном кабинете Нетологии

### Топология после выполнения задания должна выглядеть так:

[![lmOiOGwa.jpg](https://i.postimg.cc/YqNFS36Q/lmOiOGwa.jpg)](https://postimg.cc/BX6bY2wv)
 
--- 
 
## Задание 2. Создание внутреннего web-сервера и доступа к нему 

*ВАЖНО. Задание является сквозным и составлено на основе практической задачи из домашней работы “Firewall”.* 

### Описание задания
Перед вами стоит задача обеспечить доступность внутреннего web-сервера из “внешней сети”. 

### Требование к результату
- Вы должны отправить файл .pkt с выполненным заданием
- К выполненной задаче добавьте скриншоты с доступностью устройств и ответы на вопросы.

### Процесс выполнения
1. Запустите программу Cisco Packet Tracer.
2. В программе Cisco Packet Tracer загрузите предыдущую практическую работу.
3. К коммутатору в мини-офисе добавьте сервер, включите на нем HTTP-сервис и назначьте ip-адрес в любой из vlan.
4. Создайте на маршрутизаторе этой сети static nat-трансляцию для web-сервера с указанием 80 порта.
5. Из сети главного офиса получите доступ к web-серверу по “внешнему ip-адресу” роутера мини-офиса. Сделайте скриншот.
6. Обеспечьте доступность двух локальных сетей (мини-офиса и главного офиса) между собой, согласно новой топологии сети.
7. Ответ внесите в комментарии к решению задания в личном кабинете Нетологии.

### Топология после выполнения задания должна иметь следующий вид:
[![](https://i.postimg.cc/rsrP4bVV/vFjoGmMV.jpg)](https://postimg.cc/sG3mdTGq)
 
---

### Общие критерии оценки

Задание считается выполненным при соблюдении следующих условий:
1. Выполнены оба задания.
2. К заданию прикреплено 2 файла .pkt и скриншоты доступности устройств: по итогам выполнения каждого задания.
3. NAT-трансляции созданы правильно и обеспечивают доступность устройств.
4. Правильно функционирующая сеть на основе задания:
- есть доступность устройств между собой в рамках одного маршрутизатора
- есть доступность каждого устройства до второго маршрутизатора в рамках каждого сабинтерфейса
- есть доступность устройств между собой из разных сетей офисов
5. Web-сервер доступен по “внешнему ip-адресу”.
 
 </details>
 
# Ответ

Ссылка на PKT-файлы - https://drive.google.com/drive/folders/1zbosJeZmODw_WBHIfrzpX54SPJHyWX2y?usp=sharing


Главный и дочерний офис у меня перепутаны местами еще с прошлых занятий. Надеюсь, это не повлияет на результат.

За основу взято последнее задание по CPT .

На роутере главного офиса установлены логин и пароль: Chistov – Netology.

### Задание 1 – файл `SYS_4-06_NAT_Z1.pkt`.

Внешний интерфейс роутера главного офиса имеет «белый» IP-адрес 188.144.0.1/30.

Внешний интерфейс роутера дочернего офиса имеет «белый» IP-адрес 188.144.1.1/30.

Интерфейсы роутера провайдера имеют соответствующие адреса 188.144.0.2/30 и 188.144.1.2/30.


### Роутер главного офиса.

Определяем интерфейс Gi0/1 как внешний nat – `ip nat outside`.

Интерфейс, смотрящий внутрь сети и имеющий сабсети (vlan 10, 20 и 30), определяем как внутренний – `ip nat inside`.

Далее создается лист допуска (access list) для внутренних сетей с именем LIST_MAIN_OFFICE – `ip access-list standard LIST_MAIN_OFFICE`.

В этот лист добавляются внутренние сети и в данном случае надо указывать обратную маску сети:

- `permit 192.168.10.0 0.0.0.15`
- `permit 192.168.20.0 0.0.0.15`
- `permit 192.168.30.0 0.0.0.15`

Посмотреть результаты – sh r. В выводе видно, что внутренние интерфейсы предназначены для внутреннего nat, а внешний – для внешнего nat. Также виден access list.

![Снимок01](https://user-images.githubusercontent.com/121082757/223690782-114554c3-882a-4f2b-a401-e46cf3bc5bfd.PNG)

![Снимок02](https://user-images.githubusercontent.com/121082757/223690830-58185592-58b0-4e25-a6d1-0f4c8c4efce6.PNG)

Далее команда `ip nat inside source list LIST_MAIN_OFFICE interface gigabitEthernet 0/1 overload`.

Этой командой указывается, что «натить» надо внутреннюю сеть, указанную в листе допуска LIST_MAIN_OFFICE через внешний интерфейс gi0/1. Overloading в конце позволяет преобразовывать несколько внутренних адресов в один внешний.

Проверяем пинг с любого хост главного офиса на роутер провайдера.

![Снимок03](https://user-images.githubusercontent.com/121082757/223692354-63da1be7-a626-4d08-91ec-4379288f55f8.PNG)

Командой `show ip nat translations` на роутере главного офиса можно увидеть таблицу nat, в которой указано, что сигнал был с внешнего адреса роутера (188.144.0.1) из внутренней сети с адреса 192.168.20.10.

![Снимок04](https://user-images.githubusercontent.com/121082757/223690962-a52e29a5-65c6-40d6-807c-4ddadcde3034.PNG)

Все вышеперечисленные действия повторяем для дочернего офиса, в котором существует только одна сеть 192.168.0.0.



### Задание 2 – файл `SYS_4-06_NAT_Z2_Site.pkt`.

Добавить в главный офис сервер и обеспечить доступ к нему через интернет из дочернего офиса.

Сервер добавлен во VLAN20 главного офиса с местным адресом 192.168.20.5.

Для доступа к нему через интернет по «белому» IP-адресу, выданным провайдером, на роутере главного офиса надо задать статический NAT для сервера с указанием портов. В данном случае порт HTTP 80 – `ip nat inside source static tcp 192.168.20.5 80 188.144.0.1 80`.

Проверка доступа к серверу через интернет из дочернего офиса. На сервере изменено приветствие.

![Снимок05](https://user-images.githubusercontent.com/121082757/223691128-d7d280da-391a-406f-8e8e-fc12671608c7.PNG)

*Вопрос к преподавателю: можно ли настроить доступ к серверу из главного офиса, но не только по внутреннему (192.168.20.5), но и по «белому» адресу?*

*И последнее: нужно обеспечить двух локальных сетей (мини-офиса и главного офиса) между собой, согласно новой топологии сети. Тут у меня заминка. При существующих access-list связи между обеими сетями нет. Она появляется только при удалении листов доступа – `файл SYS_4-06_NAT_Z2_All.pkt`. К сожалению, у меня не получилось найти решения без удаления листов. Прошу подсказки в данном случае.*

